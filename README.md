# Secure-FUSE-FS: åŠ å¯†å‹è¨˜æ†¶é«”æª”æ¡ˆç³»çµ± (Encrypted In-Memory Filesystem)

**Secure-FUSE-FS** æ˜¯ä¸€å€‹åŸºæ–¼ C èªè¨€èˆ‡ **FUSE (Filesystem in Userspace)** ä»‹é¢å¯¦ä½œçš„è¼•é‡ç´šä½¿ç”¨è€…ç©ºé–“æª”æ¡ˆç³»çµ±ã€‚æœ¬å°ˆæ¡ˆä¸»è¦åœ¨è¨˜æ†¶é«”ä¸­é‹ä½œ (In-Memory)ï¼Œä¸¦æ•´åˆäº† **AES-256-CBC åŠ å¯†æ¼”ç®—æ³•** ä¾†ç¢ºä¿è³‡æ–™çš„æ©Ÿå¯†æ€§ã€‚

æ­¤å°ˆæ¡ˆå±•ç¤ºäº†å¦‚ä½•æ””æˆª Linux ç³»çµ±å‘¼å« (VFS å±¤) ä»¥å¯¦ä½œé€æ˜çš„åŠ è§£å¯†æ©Ÿåˆ¶ (Transparent Encryption)ï¼Œé€™æ˜¯å®‰å…¨å„²å­˜ç³»çµ±èˆ‡éŸŒé«”å®‰å…¨é ˜åŸŸä¸­çš„é—œéµæŠ€è¡“ã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½ (Key Features)

* **è‡ªå®šç¾© FUSE å¯¦ä½œ**ï¼šå®Œæ•´æ”¯æ´æ¨™æº–æª”æ¡ˆç³»çµ±æ“ä½œï¼ŒåŒ…æ‹¬ `mkdir` (å»ºç«‹ç›®éŒ„)ã€`rmdir` (ç§»é™¤ç›®éŒ„)ã€`mknod` (å»ºç«‹ç¯€é»)ã€`write` (å¯«å…¥)ã€`read` (è®€å–)ã€`open` (é–‹å•Ÿ) ä»¥åŠ `getattr` (ç²å–å±¬æ€§)ã€‚
* **é€æ˜åŠ å¯†æ©Ÿåˆ¶ (Transparent Encryption)**ï¼š
    * æ•´åˆ **OpenSSL (EVP API)** é€²è¡Œå¯†ç¢¼å­¸é‹ç®—ã€‚
    * æ¡ç”¨é«˜å¼·åº¦çš„ **AES-256-CBC** æ¼”ç®—æ³•ã€‚
    * **æª”æ¡ˆç´šå®‰å…¨ (Per-File Security)**ï¼šç³»çµ±æœƒç‚ºæ¯ä¸€å€‹æ–°å»ºç«‹çš„æª”æ¡ˆç”Ÿæˆç¨ç«‹çš„ 256-bit é‡‘é‘° (Key) èˆ‡ 128-bit åˆå§‹å‘é‡ (IV)ã€‚
* **è¨˜æ†¶é«”å…§æ¶æ§‹ (In-Memory Architecture)**ï¼šä½¿ç”¨ C èªè¨€å‹•æ…‹é™£åˆ—æ¨¡æ“¬ inode èˆ‡è³‡æ–™å€å¡Š (Data Blocks)ï¼Œæä¾›ä½å»¶é²çš„å­˜å–æ•ˆèƒ½ã€‚
* **æ˜ åƒå„²å­˜é©—è­‰ (Shadow Storage Verification)**ï¼šé›–ç„¶æ›è¼‰é»å°æˆæ¬Šä½¿ç”¨è€…é¡¯ç¤ºæ˜æ–‡ï¼Œä½†ç³»çµ±æœƒåŒæ­¥å°‡åŠ å¯†å¾Œçš„äºŒé€²ä½è³‡æ–™ (Binary Blob) å¯«å…¥å½±å­ç›®éŒ„ (`/usr/src/test_tmp`)ï¼Œä»¥é©—è­‰å¯¦é«”è³‡æ–™çš„å®‰å…¨æ€§ã€‚

## ğŸ› ï¸ ç³»çµ±æ¶æ§‹ (System Architecture)

æœ¬æª”æ¡ˆç³»çµ±é€éæ””æˆª VFS å‘¼å«ä¸¦å°‡å…¶æ˜ å°„åˆ°å…§éƒ¨çš„è¨˜æ†¶é«”çµæ§‹ä¾†é‹ä½œï¼š

1.  **å¯«å…¥æ“ä½œ (`do_write`)**ï¼š
    * ä½¿ç”¨è€…å¯«å…¥è³‡æ–™ -> FUSE æ””æˆªè«‹æ±‚ã€‚
    * ç³»çµ±ä½¿ç”¨è©²æª”æ¡ˆå°ˆå±¬çš„ AES Key/IV é€²è¡ŒåŠ å¯†ã€‚
    * åŠ å¯†å¾Œçš„è³‡æ–™è¢«å­˜å…¥è¨˜æ†¶é«”ç·©è¡å€ï¼Œä¸¦åŒæ­¥å¯«å…¥å½±å­å„²å­˜å€ä»¥é€²è¡ŒæŒä¹…åŒ–é©—è­‰ã€‚
2.  **è®€å–æ“ä½œ (`do_read`)**ï¼š
    * ä½¿ç”¨è€…è«‹æ±‚è®€å– -> FUSE æ””æˆªè«‹æ±‚ã€‚
    * ç³»çµ±å¾è¨˜æ†¶é«”ä¸­å–å‡ºåŠ å¯†è³‡æ–™ã€‚
    * è³‡æ–™é€²è¡Œå³æ™‚è§£å¯† (On-the-fly Decryption) ä¸¦å›å‚³è‡³ä½¿ç”¨è€…ç·©è¡å€ã€‚

## ğŸ’» ç’°å¢ƒéœ€æ±‚ (Prerequisites)

* **ä½œæ¥­ç³»çµ±**: Linux (å»ºè­°ä½¿ç”¨ Ubuntu 20.04/22.04)
* **å¿…è¦å‡½å¼åº«**:
    * `libfuse-dev` (FUSE é–‹ç™¼æ¨™é ­æª”)
    * `libssl-dev` (OpenSSL é–‹ç™¼æ¨™é ­æª”)
    * `gcc`, `make`

```bash
sudo apt-get update
sudo apt-get install fuse libfuse-dev libssl-dev gcc make
